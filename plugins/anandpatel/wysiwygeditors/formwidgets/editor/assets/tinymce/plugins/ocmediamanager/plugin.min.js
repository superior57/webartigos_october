/**
 * Created by anand on 3/9/2016.
 */

tinymce.PluginManager.add('ocmediamanager', function(editor, url) {
    // Add a button that opens a window
    editor.addButton('ocmediamanager', {
        text: '',
        icon: 'image',
        onclick: function() {

            new $.oc.mediaManager.popup({
                alias: 'ocmediamanager',
                cropAndInsertButton: true,
                onInsert: function(items) {
                    if (!items.length)
                    {
                        alert('Please select image(s) to insert.')
                        return;
                    }

                    for (var i=0, len=items.length; i<len; i++) {
                        if (items[i].documentType !== 'image') {
                            alert('The file "'+items[i].title+'" is not an image.')
                            continue
                        }

                        editor.insertContent('<img src="' + items[i].publicUrl + '" />');
                    }

                    this.hide();
                }
            });

        }
    });
});